# 数据库字段设计规范

#### 1. 优先选择符合存储需要的最小的数据类型

- 尽量将字符串转化为数字类型存储,使用函数转换ip，由 字符15字节 转 整型4个字节 例：
```sql
INET_ATON('255.255.255.255')=4294967295 
INET_NTOA(4294967295)='255.255.255.255'
``` 
 
 - 对于非负数据采用无符号整型进行存储
 ```sql
 有负数：signed int -2147483648~2147483647
 无负数：unsigned int 0~4294967295
 ```

 ##### 2. varchar(N) 数据类型注意事项

 - N 代表字符的个数，不是字节数，
 - `UTF8`存储汉字，每个汉字占用3个字节，`varchar(255)` 可以存储255个汉字，占用 765 个字节
 - 写入到内存时是按照 N 的长度计算并分配内存的，然后再按照实际的长度写入内存，但是计算是依然要计算N，所以尽量不要将长度设置的过长

 #### 3. 避免使用`TEXT`,`BLOB`数据类型

 - **TEXT 可以写入64K的数据**
 - 建议把BLOB或是TEXT列分离到单独的扩展表中
 - BLOB或是TEXT 只能使用前缀索引

 #### 4. 避免使用`ENUM`数据类型

 - 优点：本身是字符串类型转化成整数进行存储，有益于数据库进行优化
 - 缺陷：修改必须使用ALTER语句，频繁的操作风险比较大，ENUM类型的order by 操作效率低，需要额外操作
 - 严禁将整型数据存储为ENUM数据类型

 #### 5. 尽可能将所有字段定义为`NOT NULL`
 - 索引NULL列需要额外的空间来保存，所以要占用更多的空间
 - 进行比较和计算时要对NULL值做特别的处理

 #### 6. 使用字符串存储日期型数据（不正确的做法）

  - 缺点1： 无法用日期函数进行计算和比较
  - 缺点2：用字符串存储日期要占用更多空间
  `优化`
  - 使用`TIMESEAMP`时间存储类型 （4个字节占用，时间范围1970-01-01 00:00:01 ~ 2038-01-19 01:14:07，和`INT`类型相同，但比`INT`可读性高）
  - 使用`DATETIME`时间存储类型 （8个字节，也是INT类型，超出`TIMESEAMP`时间范围使用此类型）

#### 7. 金融财务相关数据存储：必须使用`decimal`类型

 - decimal 类型为进准浮点数，在计算时不会丢失精度
 - 占用空间由定义的宽度决定，4个字节能够存储 9 位数字，小数点占用 1 位字节
 - 可存储比`bigint`更大的整数数据

