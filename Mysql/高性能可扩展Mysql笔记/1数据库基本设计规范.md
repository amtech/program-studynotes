# 数据库基本设计规范

#### 1. 大小写敏感 `数据库对象名称必须使用小写字母并用下划线分割`

- 因为mysql使用Linux部署，Linux系统大小写敏感，所以mysql对大小写敏感，必须做区分

情况 | 第一种 |	第二种
---  |---     |------
不用的数据库名称 | DbName |	dbname
不通的表明 | Table	| table

#### 2. mysql的保留关键字 `数据库对象名称禁止使用mysql保留关键字`

`ACTION`,`ADD (R)`,`AFTER`,`AGAINST` ...........
 [MySQL 5.7参考手册  /  语言结构  /关键字和保留字](https://dev.mysql.com/doc/refman/5.7/en/keywords.html)
#### 3. 对象长度限制 `数据库对象的命名要能见到见名识意，并且最好不要超过32个字符`
 0|1 
---|---
用户数据库 | my_userdb
用户数据表 | user_account

#### 4. 数据库临时表命名规范
### `临时库表必须以 tmp为前缀，以日期为后缀` `tmp_userdb_20190101`
### `备份库表必须以 bak为前缀，以日期为后缀` `bak_userdb_20190101`

#### 5. 存储相同数据的列名和列类型必须一致
`目的是为了让相同数据类型在关联的时候提升查询性能`
![数据库列名](./images/mysql001.png)

#### 6. mysql表存储引擎选择

一些老的站使用：`mysql5.5` 以前默认存储引擎 `Myisam`

新站和所有新的开发推荐使用 `Innodb` 作为存储引擎

> mysql5.6以后`Innodb`会作为官方默认引擎，并进行了很多的优化：支持事物，行级锁，更好的恢复性，高并发下性能更好

#### 7. 数据库表和字符集选择

- 统一使用`UTF8`字符集
>兼容性更好 如果使用一些神奇的符号，可以使用UTF8扩展字符集
只存储中文字符可以使用`GBK`等字符集

- 所有列的字符集要统一，以免因为字符集转换产生的乱码

- mysql中UTF8字符 汉子占3个字节，ASCII吗占用1个字节，即 varchar 255 UTF8字符 存储中文，实际占用765个字节

#### 8. 所有表和字段都需要添加注释

- 使用 comment 从句添加表和列的备注

- 从一开始进行数据库字典的维护

#### 9. 数据表：行数限制，建议控制在500万以内
`表行数控制`
- 500万并不是mysql数据库的限制，是建议行数
- 超过500万的数据限制可以考历史归档，分库分表来实现数据行数的大小限制
- mysql数据库表行数的限制取决于存储设置和文件系统 表就是一个文件，主要看存储中单文件大小限制

`分表`

- 分区表使用：谨慎使用mysql分区表
    - 分区表在物理上存储为多个文件，在逻辑上表现为一个表（多个文件的存储会导致磁盘I/O性能的损耗）
    - 谨慎选择分区键，跨分区查询效率可能更低
- 物理分表： 建议使用物理分表的方式管理大数据，采用程序逻辑进行判定，复杂性和难度较高

`mysql单行数据大小限制：65535字节`

#### 10. 数据表：列限制，最多存储`4096`列

磁盘的IO和内存会极大的影响mysql的性能，减少列宽会在数据处理时占用更少的内存，减少磁盘打把次数，可以尽可能的提高查询效率

尽量做到冷热数据分离，减小表的宽度，就是列数：
 - 减少磁盘IO,保证热数据的内存缓存命中率
 - 利用更有效的使用缓存，避免读入无用的冷数据

 #### 11. 禁止在表中建立预留字段

 - 预留字段很难见到见名识意
 - 预留字段无法确认存储的数据类型，所以无法选择合适的类型，对预留字段类型的修改，会对表进行锁定，性能会大大降低

#### 12. 禁止在数据库中存储图片，文件等二进制数据

#### 13. 禁止在线上做数据库压力测试

#### 14. 禁止从开发环境，测试环境连接生产环境数据库（危害是巨大的，相当于作死--_--!）